<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PanagoreTrades - EVE Online Trading Dashboard</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Exo+2:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link href="https://cdn.datatables.net/1.13.7/css/jquery.dataTables.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.7/js/jquery.dataTables.min.js"></script>
    <style>
        /* ===========================================
           zKillboard-Inspired Dark Theme
           =========================================== */

        /* Root Variables */
        :root {
            --bg-primary: #000000;
            --bg-secondary: #1a1a1a;
            --bg-tertiary: #2a2a2a;
            --text-primary: #ffffff;
            --text-secondary: #cccccc;
            --text-muted: #888888;
            --border-color: #333333;
            --accent-blue: #007acc;
            --accent-green: #28a745;
            --accent-red: #dc3545;
            --accent-orange: #fd7e14;
        }

        /* Base Styling */
        * {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .orbitron {
            font-family: 'Orbitron', monospace;
        }

        body {
            background-color: var(--bg-primary);
            color: var(--text-primary);
            margin: 0;
            padding: 0;
        }

        /* zKillboard-style Cards */
        .zk-card {
            background-color: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            min-height: 120px;
        }

        /* Warehouse summary cards with better spacing */
        .warehouse-summary-card {
            min-height: 100px;
            padding: 1rem;
        }

        .warehouse-summary-card .ml-4 {
            margin-left: 0.75rem;
            min-width: 0;
            flex: 1;
        }

        .zk-card:hover {
            background-color: var(--bg-tertiary);
        }

        /* Large number display for summary cards */
        .summary-number {
            font-size: 1.25rem;
            font-weight: bold;
            font-family: 'Orbitron', monospace;
            line-height: 1.1;
            word-break: break-word;
            overflow-wrap: break-word;
            max-width: 100%;
        }

        /* Responsive adjustments for summary numbers */
        @media (max-width: 1280px) {
            .summary-number {
                font-size: 1.1rem;
            }
        }

        @media (max-width: 768px) {
            .summary-number {
                font-size: 1rem;
            }
        }

        /* Header Styling */
        header {
            background-color: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
            padding: 1rem 0;
        }

        /* Tab Styling */
        .tab-button {
            background-color: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            color: var(--text-secondary);
            padding: 0.5rem 1rem;
            border-radius: 4px 4px 0 0;
            transition: all 0.2s ease;
        }

        .tab-button.active {
            background-color: var(--bg-secondary);
            color: var(--text-primary);
            border-bottom-color: var(--bg-secondary);
        }

        .tab-button:hover {
            background-color: var(--bg-secondary);
            color: var(--text-primary);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Clean Tables */
        .zk-table {
            background-color: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            overflow: hidden;
        }

        .zk-table thead {
            background-color: var(--bg-tertiary);
        }

        .zk-table th {
            color: var(--text-primary);
            font-weight: 600;
            padding: 0.75rem;
            border-bottom: 1px solid var(--border-color);
            text-align: left;
        }

        .zk-table td {
            padding: 0.75rem;
            border-bottom: 1px solid var(--border-color);
            color: var(--text-secondary);
        }

        .zk-table tr:hover {
            background-color: var(--bg-tertiary);
        }

        /* Simple Buttons */
        .zk-button {
            background-color: var(--accent-blue);
            color: white;
            border: none;
            padding: 0.5rem 0.875rem;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.2s ease;
            font-size: 0.875rem;
            white-space: nowrap;
        }

        .zk-button:hover {
            background-color: #0056b3;
        }

        .zk-button-secondary {
            background-color: var(--bg-tertiary);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
            padding: 0.5rem 0.875rem;
            font-size: 0.875rem;
            white-space: nowrap;
        }

        .zk-button-secondary:hover {
            background-color: var(--bg-secondary);
        }

        /* Responsive button adjustments */
        @media (max-width: 768px) {
            .zk-button, .zk-button-secondary {
                padding: 0.375rem 0.75rem;
                font-size: 0.8rem;
            }
        }

        /* Input Styling */
        .zk-input {
            background-color: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
            padding: 0.5rem;
            border-radius: 4px;
        }

        .zk-input:focus {
            outline: none;
            border-color: var(--accent-blue);
        }

        /* Profit Colors */
        .profit-positive {
            color: var(--accent-green);
        }

        .profit-negative {
            color: var(--accent-red);
        }

        /* ISK Format */
        .isk-format {
            font-family: 'Orbitron', monospace;
            font-weight: 500;
        }

        /* Loading Spinner */
        .loading-spinner {
            border: 3px solid var(--border-color);
            border-top: 3px solid var(--accent-blue);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Margin Colors */
        .margin-high {
            color: var(--accent-green);
        }
        .margin-medium {
            color: var(--accent-orange);
        }
        .margin-low {
            color: var(--text-muted);
        }

        /* Hub Cards */
        .hub-card {
            background-color: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            padding: 0.75rem;
            text-align: center;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }

        .hub-card:hover {
            background-color: var(--bg-secondary);
        }

        .hub-card.selected {
            background-color: var(--accent-blue);
            color: white;
        }

        /* Filter Sections */
        .filter-section {
            background-color: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            padding: 1rem;
            margin-bottom: 1rem;
        }

        .filter-header {
            color: var(--text-primary);
            font-weight: 600;
            margin-bottom: 1rem;
            font-size: 0.875rem;
        }

        /* Refresh animation */
        .refresh-spin {
            animation: spin 1s linear infinite;
        }

        /* DataTables Dark Theme Override */
        #trades-table {
            background-color: var(--bg-secondary) !important;
            color: var(--text-primary) !important;
            border: none !important;
        }

        #trades-table thead th {
            background-color: var(--bg-tertiary) !important;
            color: var(--text-primary) !important;
            border-bottom: 2px solid var(--border-color) !important;
            padding: 8px !important;
            font-size: 0.875rem !important;
            font-weight: 600 !important;
        }

        #trades-table thead #column-filters th {
            background-color: var(--bg-secondary) !important;
            padding: 4px !important;
            border-bottom: 1px solid var(--border-color) !important;
        }

        #trades-table tbody tr {
            background-color: var(--bg-secondary) !important;
            border-bottom: 1px solid var(--border-color) !important;
        }

        #trades-table tbody tr:hover {
            background-color: var(--bg-tertiary) !important;
        }

        #trades-table tbody td {
            color: var(--text-primary) !important;
            padding: 6px 8px !important;
            font-size: 0.8125rem !important;
        }

        #trades-table thead #column-filters input {
            width: 100% !important;
            padding: 4px !important;
            background-color: var(--bg-tertiary) !important;
            border: 1px solid var(--border-color) !important;
            color: var(--text-primary) !important;
            font-size: 0.75rem !important;
            border-radius: 3px !important;
            box-sizing: border-box !important;
        }

        #trades-table thead #column-filters input:focus {
            outline: none !important;
            border-color: var(--accent-blue) !important;
        }

        .dataTables_wrapper {
            color: var(--text-primary) !important;
        }

        .dataTables_length,
        .dataTables_filter,
        .dataTables_info,
        .dataTables_paginate {
            color: var(--text-primary) !important;
            font-size: 0.875rem !important;
        }

        .dataTables_length select {
            background-color: var(--bg-tertiary) !important;
            border: 1px solid var(--border-color) !important;
            color: var(--text-primary) !important;
            padding: 4px !important;
            border-radius: 3px !important;
        }

        .dataTables_paginate .paginate_button {
            background-color: var(--bg-tertiary) !important;
            color: var(--text-primary) !important;
            border: 1px solid var(--border-color) !important;
            border-radius: 3px !important;
            padding: 4px 10px !important;
            margin: 0 2px !important;
        }

        .dataTables_paginate .paginate_button:hover {
            background-color: var(--accent-blue) !important;
            color: white !important;
            border-color: var(--accent-blue) !important;
        }

        .dataTables_paginate .paginate_button.current {
            background-color: var(--accent-blue) !important;
            color: white !important;
            border-color: var(--accent-blue) !important;
        }

        .dataTables_paginate .paginate_button.disabled {
            opacity: 0.5 !important;
            cursor: not-allowed !important;
        }

        /* Trade Hub Route Filter */
        .hub-checkbox-label {
            display: flex;
            align-items: center;
            padding: 6px 12px;
            background-color: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.875rem;
        }

        .hub-checkbox-label:hover {
            background-color: var(--bg-tertiary);
            border-color: var(--accent-blue);
        }

        .hub-checkbox-label.selected {
            background-color: var(--accent-blue);
            border-color: var(--accent-blue);
            color: white;
            box-shadow: 0 0 10px rgba(0, 122, 204, 0.3);
        }

        .hub-checkbox {
            margin-right: 8px;
            width: 16px;
            height: 16px;
            cursor: pointer;
        }

        #route-svg path {
            stroke-width: 2.5;
            fill: none;
            stroke: url(#lineGradient);
            opacity: 0;
            stroke-linecap: round;
            stroke-linejoin: round;
            filter: drop-shadow(0 0 8px rgba(0, 122, 204, 0.6));
            stroke-dasharray: 1000;
            stroke-dashoffset: 1000;
            animation: organicFlow 2.5s cubic-bezier(0.4, 0, 0.2, 1) forwards;
        }

        #route-svg path.active {
            animation: organicFlow 2.5s cubic-bezier(0.4, 0, 0.2, 1) forwards,
                       breathe 4s ease-in-out infinite 2.5s;
        }

        @keyframes organicFlow {
            0% {
                stroke-dashoffset: 1000;
                opacity: 0;
                stroke-width: 1;
            }
            40% {
                opacity: 0.6;
                stroke-width: 4;
            }
            100% {
                stroke-dashoffset: 0;
                opacity: 0.85;
                stroke-width: 2.5;
            }
        }

        @keyframes breathe {
            0%, 100% {
                stroke-width: 2.5;
                opacity: 0.85;
                filter: drop-shadow(0 0 8px rgba(0, 122, 204, 0.6));
            }
            50% {
                stroke-width: 3.5;
                opacity: 1;
                filter: drop-shadow(0 0 15px rgba(0, 122, 204, 0.9));
            }
        }

        /* Rifter Ship - PNG Based */
        .hauler-ship {
            position: absolute;
            width: 60px;
            height: 60px;
            pointer-events: none;
            filter: drop-shadow(0 0 8px rgba(16, 185, 129, 0.4));
        }

        .hauler-ship img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            animation: shipBob 3s ease-in-out infinite;
        }

        /* Animated overlay effects */
        .hauler-ship::before {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at 30% 50%, rgba(16, 185, 129, 0.3) 0%, transparent 60%);
            animation: enginePulse 1.5s ease-in-out infinite;
            pointer-events: none;
        }

        .hauler-ship::after {
            content: '';
            position: absolute;
            width: 20px;
            height: 3px;
            background: linear-gradient(90deg, transparent, rgba(16, 185, 129, 0.6), transparent);
            left: -25px;
            top: 50%;
            animation: warpTrail 2s linear infinite;
            pointer-events: none;
        }

        @keyframes shipBob {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-3px); }
        }

        @keyframes enginePulse {
            0%, 100% { opacity: 0.4; transform: scale(0.9); }
            50% { opacity: 0.8; transform: scale(1.1); }
        }

        @keyframes warpTrail {
            0% { opacity: 0; transform: translateX(0px); }
            50% { opacity: 1; }
            100% { opacity: 0; transform: translateX(-15px); }
        }

        @keyframes engineGlow {
            0%, 100% {
                opacity: 0.8;
                box-shadow: 0 0 8px rgba(253, 126, 20, 0.8);
            }
            50% {
                opacity: 1;
                box-shadow: 0 0 15px rgba(253, 126, 20, 1);
            }
        }

        @keyframes cockpitBlink {
            0%, 90%, 100% {
                opacity: 0.6;
            }
            95% {
                opacity: 1;
            }
        }

        /* Chart container with fixed height */
        .chart-container {
            height: 300px;
            max-height: 300px;
        }

        /* Sortable headers */
        .sortable {
            cursor: pointer;
            user-select: none;
        }
        .sortable:hover {
            background-color: rgba(59, 130, 246, 0.1);
        }
        .sort-icon {
            display: inline-block;
            margin-left: 5px;
            opacity: 0.5;
        }
        .sort-active {
            opacity: 1;
        }







        /* Collapsible section styling */
        .collapsible-header {
            cursor: pointer;
            user-select: none;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0.75rem;
            border-radius: 0.5rem;
            margin-bottom: 0.75rem;
        }
        .collapsible-header:hover {
            background-color: var(--bg-tertiary);
        }

        .collapsible-content {
            max-height: 1000px;
            overflow: hidden;
            transition: max-height 0.4s ease-in-out, opacity 0.3s ease-in-out;
            opacity: 1;
        }
        .collapsible-content.collapsed {
            max-height: 0;
            opacity: 0;
            transition: max-height 0.4s ease-in-out, opacity 0.2s ease-in-out;
        }

        .collapse-icon {
            transition: transform 0.3s ease;
            font-size: 0.875rem;
            color: var(--text-muted);
        }
        .collapse-icon.rotated {
            transform: rotate(180deg);
        }

        /* Advanced filters default collapsed state */
        .advanced-filters {
            border: 1px solid var(--border-color);
            border-radius: 0.5rem;
            background-color: var(--bg-secondary);
            padding: 0;
            margin-bottom: 1rem;
            overflow: hidden;
        }

        .advanced-filters-content {
            padding: 1.5rem;
            padding-top: 0;
        }

        /* Profit Margin Slider Styling - Using warehouse item hover colors */
        input[type="range"] {
            -webkit-appearance: none;
            appearance: none;
            height: 8px;
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            outline: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            background: var(--bg-tertiary);
            border: 2px solid var(--accent-blue);
            border-radius: 4px;
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0,0,0,0.3);
            transition: all 0.2s ease;
        }

        input[type="range"]::-webkit-slider-thumb:hover {
            background: var(--bg-secondary);
            border-color: var(--accent-green);
            transform: scale(1.1);
            box-shadow: 0 4px 12px rgba(0,0,0,0.4);
        }

        input[type="range"]::-moz-range-thumb {
            width: 24px;
            height: 24px;
            background: var(--bg-tertiary);
            border: 2px solid var(--accent-blue);
            border-radius: 4px;
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0,0,0,0.3);
            transition: all 0.2s ease;
        }

        input[type="range"]::-moz-range-thumb:hover {
            background: var(--bg-secondary);
            border-color: var(--accent-green);
        }
    </style>
</head>
<body class="min-h-screen">
    <!-- Header -->
    <header class="shadow-lg">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center py-6">
                <div class="flex items-center">
                    <i class="fas fa-satellite text-3xl mr-3" style="color: var(--accent-blue);"></i>
                    <h1 class="text-3xl font-bold orbitron" style="color: var(--text-primary);">PanagoreTrades</h1>
                </div>
                <div class="flex items-center space-x-4">
                    <!-- Auto-check status -->
                    <div class="text-right mr-4">
                        <p class="text-xs" style="color: var(--text-muted);">Auto-check</p>
                        <p class="text-xs font-medium orbitron" style="color: var(--accent-blue);" id="next-check-time">Every 25min</p>
                    </div>

                    <!-- Refresh Button -->
                    <button onclick="refreshAllData()"
                            class="zk-button flex items-center"
                            title="Refresh all data">
                        <i class="fas fa-sync-alt mr-2"></i>
                        <span class="hidden sm:inline">Refresh</span>
                    </button>

                    <div class="text-right">
                        <p class="text-sm" style="color: var(--text-muted);">Character</p>
                        <p class="font-semibold orbitron" style="color: var(--text-primary);" id="character-name">Loading...</p>
                    </div>
                    <div class="w-10 h-10 rounded-full flex items-center justify-center" style="background-color: var(--bg-tertiary); border: 1px solid var(--border-color);">
                        <i class="fas fa-user" style="color: var(--text-primary);"></i>
                    </div>


                </div>
            </div>
        </div>
    </header>

    <!-- Navigation Tabs -->
    <nav class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pt-8">
        <div class="flex space-x-8">
            <button onclick="switchTab('trading')" class="tab-button active px-3 py-2 text-sm font-medium rounded-md transition-colors duration-200" id="trading-tab">
                <i class="fas fa-chart-line mr-2"></i>Trading Opportunities
            </button>
            <button onclick="switchTab('warehouse')" class="tab-button px-3 py-2 text-sm font-medium rounded-md transition-colors duration-200" id="warehouse-tab">
                <i class="fas fa-warehouse mr-2"></i>Warehouse Management
            </button>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">

        <!-- Trading Tab Content -->
        <div id="trading-content" class="tab-content active">
            <!-- Wallet Summary Cards -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
            <!-- Corporation Wallet -->
            <div class="zk-card">
                <div class="flex items-center">
                    <div class="p-3 rounded" style="background-color: var(--bg-tertiary); border: 1px solid var(--border-color);">
                        <i class="fas fa-industry text-xl" style="color: var(--accent-blue);"></i>
                    </div>
                    <div class="ml-4">
                        <p class="text-sm font-medium" style="color: var(--text-secondary);" id="corp-name">Corporation ISK</p>
                        <p class="text-2xl font-bold isk-format" style="color: var(--text-primary);" id="corp-wallet">Loading...</p>
                    </div>
                </div>
            </div>

            <!-- Character Wallet -->
            <div class="zk-card">
                <div class="flex items-center">
                    <div class="p-3 rounded" style="background-color: var(--bg-tertiary); border: 1px solid var(--border-color);">
                        <i class="fas fa-wallet text-xl" style="color: var(--accent-orange);"></i>
                    </div>
                    <div class="ml-4">
                        <p class="text-sm font-medium" style="color: var(--text-secondary);">Personal ISK</p>
                        <p class="text-2xl font-bold isk-format" style="color: var(--text-primary);" id="char-wallet">Loading...</p>
                    </div>
                </div>
            </div>

            <!-- 7-Day Profit -->
            <div class="zk-card">
                <div class="flex items-center">
                    <div class="p-3 rounded" style="background-color: var(--bg-tertiary); border: 1px solid var(--border-color);">
                        <i class="fas fa-chart-line text-xl" style="color: var(--accent-green);"></i>
                    </div>
                    <div class="ml-4">
                        <p class="text-sm font-medium" style="color: var(--text-secondary);">7-Day Profit</p>
                        <p class="text-2xl font-bold profit-positive isk-format" id="week-profit">Loading...</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Trading Opportunities -->
        <div class="zk-table">
            <div class="p-4" style="border-bottom: 1px solid var(--border-color);">
                <div class="flex justify-between items-center mb-3">
                    <h2 class="text-lg font-bold orbitron" style="color: var(--text-primary);">
                        <i class="fas fa-chart-line mr-2" style="color: var(--accent-blue);"></i>Trading Opportunities
                    </h2>
                </div>

                <!-- Global Search -->
                <div class="mb-3">
                    <input type="text" id="global-search" placeholder="Search all columns..." class="w-full zk-input text-sm py-2">
                </div>

                <!-- Trade Hub Route Filter -->
                <div class="mb-4 p-4" style="background-color: var(--bg-tertiary); border-radius: 8px; border: 1px solid var(--border-color);">
                    <div class="flex justify-between items-center mb-3">
                        <h3 class="text-sm font-bold" style="color: var(--text-primary);">
                            <i class="fas fa-route mr-2" style="color: var(--accent-blue);"></i>Select Trade Routes
                        </h3>
                        <button onclick="clearHubSelection()" class="text-xs px-3 py-1 rounded" style="background-color: var(--bg-secondary); border: 1px solid var(--border-color); color: var(--text-secondary);">
                            <i class="fas fa-times mr-1"></i>Clear All
                        </button>
                    </div>

                    <div class="relative" style="height: 220px;">
                        <!-- SVG for animated connections -->
                        <svg id="route-svg" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 1;">
                            <defs>
                                <linearGradient id="lineGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                                    <stop offset="0%" style="stop-color:var(--accent-orange);stop-opacity:1" />
                                    <stop offset="100%" style="stop-color:var(--accent-green);stop-opacity:1" />
                                </linearGradient>
                            </defs>
                        </svg>

                        <!-- Buy Hubs (Left) -->
                        <div style="position: absolute; left: 20px; top: 0; z-index: 2;">
                            <div class="text-xs font-bold mb-2" style="color: var(--accent-orange);">
                                <i class="fas fa-shopping-cart mr-1"></i>Buy From
                            </div>
                            <div id="buy-hubs" class="space-y-2">
                                <!-- Dynamically populated -->
                            </div>
                        </div>

                        <!-- Sell Hubs (Right) -->
                        <div style="position: absolute; right: 20px; top: 0; z-index: 2;">
                            <div class="text-xs font-bold mb-2" style="color: var(--accent-green);">
                                <i class="fas fa-hand-holding-usd mr-1"></i>Sell To
                            </div>
                            <div id="sell-hubs" class="space-y-2">
                                <!-- Dynamically populated -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Soft Filters -->
                <div class="grid grid-cols-2 md:grid-cols-4 gap-3 mb-3">
                    <div>
                        <label class="block text-xs mb-1" style="color: var(--text-secondary);">Min Margin %</label>
                        <input type="number" id="soft-min-margin" placeholder="0" class="w-full zk-input text-sm py-1">
                    </div>
                    <div>
                        <label class="block text-xs mb-1" style="color: var(--text-secondary);">Max Margin %</label>
                        <input type="number" id="soft-max-margin" placeholder="Unlimited" class="w-full zk-input text-sm py-1">
                    </div>
                    <div>
                        <label class="block text-xs mb-1" style="color: var(--text-secondary);">Min Volume</label>
                        <input type="number" id="soft-min-volume" placeholder="0" class="w-full zk-input text-sm py-1">
                    </div>
                    <div>
                        <label class="block text-xs mb-1" style="color: var(--text-secondary);">Min Price (ISK)</label>
                        <input type="number" id="soft-min-price" placeholder="0" class="w-full zk-input text-sm py-1">
                    </div>
                </div>
            </div>

            <!-- Loading State -->
            <div id="loading-trades" class="p-8 text-center">
                <div class="loading-spinner w-12 h-12 mx-auto mb-4"></div>
                <p style="color: var(--text-secondary);">Loading trading opportunities...</p>
            </div>

            <!-- Trading Table -->
            <div id="trades-container" class="hidden">
                <div class="overflow-x-auto p-4">
                    <table id="trades-table" class="display compact nowrap" style="width:100%">
                        <thead>
                            <tr>
                                <th>Item</th>
                                <th>Margin %</th>
                                <th>Profit</th>
                                <th>Route</th>
                                <th>Buy Vol</th>
                                <th>Sell Vol</th>
                                <th>Buy Price</th>
                                <th>Sell Price</th>
                            </tr>
                            <tr id="column-filters">
                                <th>Item</th>
                                <th>Margin %</th>
                                <th>Profit</th>
                                <th>Route</th>
                                <th>Buy Vol</th>
                                <th>Sell Vol</th>
                                <th>Buy Price</th>
                                <th>Sell Price</th>
                            </tr>
                        </thead>
                        <tbody id="trades-tbody">
                            <!-- Dynamically populated -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

            <!-- Profit Chart -->
            <div class="zk-card mt-8">
                <h2 class="text-xl font-bold mb-4 orbitron" style="color: var(--text-primary);">7-Day Profit History</h2>
                <div class="chart-container">
                    <canvas id="profitChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Warehouse Tab Content -->
        <div id="warehouse-content" class="tab-content">
            <!-- Warehouse Summary Cards -->
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4 mb-8">
                <!-- Theoretical Value -->
                <div class="zk-card warehouse-summary-card">
                    <div class="flex items-center">
                        <div class="p-2 rounded" style="background-color: var(--bg-tertiary); border: 1px solid var(--border-color);">
                            <i class="fas fa-warehouse text-lg" style="color: var(--accent-blue);"></i>
                        </div>
                        <div class="ml-4">
                            <p class="text-xs font-medium" style="color: var(--text-secondary);">Theoretical Value</p>
                            <p class="summary-number isk-format" style="color: var(--text-primary);" id="total-warehouse-value">Loading...</p>
                        </div>
                    </div>
                </div>

                <!-- Actual Profit -->
                <div class="zk-card warehouse-summary-card">
                    <div class="flex items-center">
                        <div class="p-2 rounded" style="background-color: var(--bg-tertiary); border: 1px solid var(--border-color);">
                            <i class="fas fa-coins text-lg" style="color: var(--accent-green);"></i>
                        </div>
                        <div class="ml-4">
                            <p class="text-xs font-medium" style="color: var(--text-secondary);">Realized Profit (30d)</p>
                            <p class="summary-number isk-format profit-positive" id="total-actual-profit">Loading...</p>
                        </div>
                    </div>
                </div>

                <!-- ISK in Orders -->
                <div class="zk-card warehouse-summary-card">
                    <div class="flex items-center">
                        <div class="p-2 rounded" style="background-color: var(--bg-tertiary); border: 1px solid var(--border-color);">
                            <i class="fas fa-chart-line text-lg" style="color: var(--accent-orange);"></i>
                        </div>
                        <div class="ml-4">
                            <p class="text-xs font-medium" style="color: var(--text-secondary);">ISK in Orders</p>
                            <p class="summary-number isk-format" style="color: var(--text-primary);" id="isk-in-orders">Loading...</p>
                        </div>
                    </div>
                </div>

                <!-- Courier Collateral -->
                <div class="zk-card warehouse-summary-card">
                    <div class="flex items-center">
                        <div class="p-2 rounded" style="background-color: var(--bg-tertiary); border: 1px solid var(--border-color);">
                            <i class="fas fa-shipping-fast text-lg" style="color: var(--accent-orange);"></i>
                        </div>
                        <div class="ml-4">
                            <p class="text-xs font-medium" style="color: var(--text-secondary);">Courier Collateral</p>
                            <p class="summary-number" style="color: var(--text-primary);" id="courier-collateral">Loading...</p>
                        </div>
                    </div>
                </div>

                <!-- Open Courier Contracts -->
                <div class="zk-card warehouse-summary-card">
                    <div class="flex items-center">
                        <div class="p-2 rounded" style="background-color: var(--bg-tertiary); border: 1px solid var(--border-color);">
                            <i class="fas fa-clipboard-list text-lg" style="color: var(--accent-blue);"></i>
                        </div>
                        <div class="ml-4">
                            <p class="text-xs font-medium" style="color: var(--text-secondary);">Open Courier Contracts</p>
                            <p class="summary-number" style="color: var(--text-primary);" id="open-courier-contracts">Loading...</p>
                        </div>
                    </div>
                </div>
                <!-- Unfinished Contracts -->
                <div class="zk-card warehouse-summary-card" id="unfinished-contracts-card" style="display: none;">
                    <div class="flex items-center">
                        <div class="p-2 rounded" style="background-color: var(--bg-tertiary); border: 1px solid var(--border-color);">
                            <i class="fas fa-clock text-lg" style="color: var(--accent-orange);"></i>
                        </div>
                        <div class="ml-4">
                            <p class="text-xs font-medium" style="color: var(--text-secondary);">Unfinished</p>
                            <p class="summary-number" style="color: var(--text-primary);" id="unfinished-contracts-count">0</p>
                        </div>
                    </div>
                </div>
            </div>


            <!-- Warehouse Controls -->
            <div class="zk-card">
                <div class="flex flex-col sm:flex-row sm:justify-between sm:items-center mb-4 space-y-3 sm:space-y-0">
                    <h2 class="text-lg sm:text-xl font-bold orbitron flex items-center" style="color: var(--text-primary);">
                        <i class="fas fa-cogs mr-2 sm:mr-3" style="color: var(--accent-blue);"></i>Warehouse Controls
                    </h2>
                    <div class="flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-3">
                        <button onclick="refreshWarehouseData()" class="zk-button">
                            <i class="fas fa-sync-alt mr-2"></i><span class="hidden sm:inline">Refresh </span>Data
                        </button>
                        <button onclick="toggleAssetSource()" class="zk-button-secondary" id="asset-source-toggle">
                            <i class="fas fa-building mr-2"></i><span class="hidden sm:inline">Corp </span>Assets
                        </button>
                        <button onclick="showSkillsModal()" class="zk-button-secondary">
                            <i class="fas fa-user-graduate mr-2"></i><span class="hidden sm:inline">Update </span>Skills
                        </button>
                    </div>
                </div>


                <!-- Hub Selection -->
                <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4">
                    <div class="hub-card" onclick="selectWarehouseHub('all')" id="hub-all">
                        <i class="fas fa-globe text-2xl mb-2" style="color: var(--accent-blue);"></i>
                        <p class="font-medium" style="color: var(--text-primary);">All Hubs</p>
                        <p class="text-sm" style="color: var(--text-muted);" id="all-items-count">0 items</p>
                    </div>
                    <div class="hub-card" onclick="selectWarehouseHub('Jita')" id="hub-Jita">
                        <i class="fas fa-building text-2xl mb-2" style="color: var(--accent-blue);"></i>
                        <p class="font-medium" style="color: var(--text-primary);">Jita</p>
                        <p class="text-sm" style="color: var(--text-muted);" id="jita-items-count">0 items</p>
                    </div>
                    <div class="hub-card" onclick="selectWarehouseHub('Amarr')" id="hub-Amarr">
                        <i class="fas fa-building text-2xl mb-2" style="color: var(--accent-orange);"></i>
                        <p class="font-medium" style="color: var(--text-primary);">Amarr</p>
                        <p class="text-sm" style="color: var(--text-muted);" id="amarr-items-count">0 items</p>
                    </div>
                    <div class="hub-card" onclick="selectWarehouseHub('Rens')" id="hub-Rens">
                        <i class="fas fa-building text-2xl mb-2" style="color: var(--accent-green);"></i>
                        <p class="font-medium" style="color: var(--text-primary);">Rens</p>
                        <p class="text-sm" style="color: var(--text-muted);" id="rens-items-count">0 items</p>
                    </div>
                    <div class="hub-card" onclick="selectWarehouseHub('Dodixie')" id="hub-Dodixie">
                        <i class="fas fa-building text-2xl mb-2" style="color: var(--accent-blue);"></i>
                        <p class="font-medium" style="color: var(--text-primary);">Dodixie</p>
                        <p class="text-sm" style="color: var(--text-muted);" id="dodixie-items-count">0 items</p>
                    </div>
                    <div class="hub-card" onclick="selectWarehouseHub('Hek')" id="hub-Hek">
                        <i class="fas fa-building text-2xl mb-2" style="color: var(--accent-red);"></i>
                        <p class="font-medium" style="color: var(--text-primary);">Hek</p>
                        <p class="text-sm" style="color: var(--text-muted);" id="hek-items-count">0 items</p>
                    </div>
                </div>
            </div>

            <!-- Warehouse Items Display -->
            <div class="zk-table">
                <div class="p-6" style="border-bottom: 1px solid var(--border-color);">
                    <div class="flex justify-between items-center">
                        <h2 class="text-xl font-bold orbitron" style="color: var(--text-primary);">Warehouse Items - <span id="selected-hub-name">All Hubs</span></h2>
                        <div class="flex items-center">
                            <span class="text-sm mr-2" style="color: var(--text-secondary);">Items:</span>
                            <span class="text-sm font-medium px-2.5 py-0.5 rounded orbitron" style="background-color: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border-color);" id="warehouse-items-count">0</span>
                        </div>
                    </div>
                </div>

                <!-- Loading State -->
                <div id="loading-warehouse" class="p-8 text-center">
                    <div class="loading-spinner w-12 h-12 mx-auto mb-4"></div>
                    <p style="color: var(--text-secondary);">Loading warehouse data...</p>
                </div>

                <!-- Warehouse Table -->
                <div id="warehouse-container" class="hidden">
                    <div class="overflow-x-auto">
                        <table class="min-w-full">
                            <thead>
                                <tr>
                                    <th class="px-6 py-3 text-left" style="color: var(--text-primary);">
                                        Item Details
                                    </th>
                                    <th class="px-6 py-3 text-left" style="color: var(--text-primary);">
                                        Quantity
                                    </th>
                                    <th class="px-6 py-3 text-left" style="color: var(--text-primary);">
                                        Avg. Buy Price
                                    </th>
                                    <th class="px-6 py-3 text-left" style="color: var(--text-primary);">
                                        Live Price
                                    </th>
                                    <th class="px-6 py-3 text-left" style="color: var(--text-primary);">
                                        Possible Profit
                                    </th>
                                    <th class="px-6 py-3 text-left" style="color: var(--text-primary);">
                                        Orders
                                    </th>
                                    <th class="px-6 py-3 text-left" style="color: var(--text-primary);">
                                        Order Prices
                                    </th>
                                </tr>
                            </thead>
                            <tbody id="warehouse-tbody">
                                <!-- Dynamically populated -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Market Orders Section -->
            <div class="zk-table mt-8">
                <div class="p-6" style="border-bottom: 1px solid var(--border-color);">
                    <div class="flex justify-between items-center">
                        <h2 class="text-xl font-bold orbitron" style="color: var(--text-primary);">
                            <i class="fas fa-exchange-alt mr-3" style="color: var(--accent-blue);"></i>Active Market Orders
                        </h2>
                        <div class="flex items-center space-x-4">
                            <div class="flex items-center">
                                <span class="text-sm mr-2" style="color: var(--text-secondary);">Active:</span>
                                <span class="text-sm font-medium px-2.5 py-0.5 rounded orbitron" style="background-color: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border-color);" id="active-orders-count">0</span>
                            </div>
                            <div class="flex items-center">
                                <span class="text-sm mr-2" style="color: var(--text-secondary);">Completed:</span>
                                <span class="text-sm font-medium px-2.5 py-0.5 rounded orbitron" style="background-color: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border-color);" id="completed-orders-count">0</span>
                            </div>
                            <button onclick="clearCompletedOrders()" class="zk-button-secondary text-sm">
                                <i class="fas fa-trash mr-2"></i>Clear Completed
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Market Orders Content -->
                <div id="market-orders-loading" class="flex items-center justify-center p-12">
                    <div class="animate-pulse text-center">
                        <i class="fas fa-spinner fa-spin text-2xl mb-4" style="color: var(--accent-blue);"></i>
                        <p style="color: var(--text-muted);">Loading market orders...</p>
                    </div>
                </div>

                <!-- Market Orders Table -->
                <div id="market-orders-container" class="hidden">
                    <div class="overflow-x-auto">
                        <table class="min-w-full">
                            <thead style="background-color: var(--bg-secondary);">
                                <tr style="border-bottom: 1px solid var(--border-color);">
                                    <th class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider" style="color: var(--text-muted);">Item</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider" style="color: var(--text-muted);">Type</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider" style="color: var(--text-muted);">Price</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider" style="color: var(--text-muted);">Volume</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider" style="color: var(--text-muted);">Progress</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider" style="color: var(--text-muted);">Location</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider" style="color: var(--text-muted);">Issued</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider" style="color: var(--text-muted);">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="market-orders-table-body" style="background-color: var(--bg-primary);">
                                <!-- Dynamically populated -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Empty State -->
                <div id="market-orders-empty" class="hidden text-center p-12">
                    <i class="fas fa-inbox text-4xl mb-4" style="color: var(--text-muted);"></i>
                    <p class="text-lg font-medium mb-2" style="color: var(--text-primary);">No Market Orders</p>
                    <p style="color: var(--text-muted);">No active or completed market orders found.</p>
                </div>
            </div>
        </div>

    </main>

    <script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
</body>
</html>